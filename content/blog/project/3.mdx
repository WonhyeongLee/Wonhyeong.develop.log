---
title: Next.JS 13의 APP Router 사용해 클라이언트 요청 핸들러 구현
date: '2023-08-29'
description: '@graphql-tools의 mock을 이용해 테스트데이터로 메인페이지의 카드 요약 부분 구현'
tags: ['Nextjs', 'GraphQL', 'Typescript', 'Project', 'React', 'Mock']
category: '프로젝트'
---

## 개요

## 구현

## 고민했던 부분

[Mocking FE at Kakao Tech](https://tech.kakao.com/2021/09/29/mocking-fe/)

[Apollo Server Testing and Mocking](https://www.apollographql.com/docs/apollo-server/testing/mocking/)
[GraphQL Tools MockServer](https://the-guild.dev/graphql/tools/docs/mocking#mockserver)

[Extending the req/res objects with TypeScript in Next.js](https://nextjs.org/docs/pages/building-your-application/routing/api-routes#extending-the-req--res-objects-with-typescript)

[GraphQL Tools Issues](https://github.com/ardatan/graphql-tools/issues?page=3&q=is%3Aissue+is%3Aopen)

문제들

1. api 라우터일 때 api/graphql.ts 식으로 작성하라는 글이 많았는데 공식문서보니 그냥 api/route.ts 으로 하길래 그대로 함
2. POST 요청할 때 공식문서 app 라우터 기준은 NextResponse를 사용하고 있음
   graphql은 쿼리를 보내야해서 POST요청
   NextapiResponse를 사용하면 이상하게 res가 params : undefined로 덮어씌워짐.
   -> 결국은 공식문서대로 하는게 작동한다. 너무 여러 정보가 섞여있음
3. sumonner에서 title 부분을 fragment로 따로 설정해서 썼는데 클라이언트에 값이 들어갈 때 fragment 부분만 데이터가 안가짐. 서버에서 로그를 찍어보면 잘 반환되는데. 찾아본 결과 \_\_typename으로 받을 객체의 타입을 확실히 해줘야 하는거 같음.
4. [](https://it-eldorado.tistory.com/179)
   [](https://stackoverflow.com/questions/63362483/apollo-client-fragments-not-embedding-data)
